created: 20250629133737467
description: Luaæ¨¡å—ä¸åŒ…å®é™…åº”ç”¨æ¡ˆä¾‹
modified: 20250629133857917
modifier: uzvg
progress: Completed
rating: Plain
source: Luaæ¨¡å—ä¸åŒ…åŸºç¡€
tags: PermanentNotes Lua
title: Luaæ¨¡å—ä¸åŒ…å®é™…åº”ç”¨æ¡ˆä¾‹
type: text/vnd.tiddlywiki
visibility: Public

éå¸¸å¥½ï¼Œæˆ‘ä»¬æ¥ç»™ä¸€ä¸ª''å¤šæ–‡ä»¶åŒ…çš„å®é™…æ¡ˆä¾‹''ï¼Œè®©ä½ å®Œæ•´æŒæ¡ï¼š

> ''ç›®æ ‡ï¼š''
> åˆ›å»ºä¸€ä¸ªå« `mymath` çš„åŒ…ï¼Œé‡Œé¢æœ‰ä¸¤ä¸ªæ¨¡å—ï¼š

* `add.lua`ï¼šæä¾›åŠ æ³•
* `mul.lua`ï¼šæä¾›ä¹˜æ³•

ç„¶åé€šè¿‡ä¸€ä¸ªä¸»æ¨¡å— `mymath.lua` æŠŠå®ƒä»¬æ•´åˆå¯¹å¤–æš´éœ²ã€‚

!! ğŸ¯ ç›®å½•ç»“æ„

å‡è®¾ä½ çš„é¡¹ç›®ç›®å½•æ˜¯ï¼š

```
project/
  main.lua
  mymath/
    init.lua
    add.lua
    mul.lua
```

> æ³¨ï¼šæœ‰çš„é¡¹ç›®ä¼šæŠŠä¸»æ¨¡å—å« `init.lua`ï¼Œè¿™æ · `require("mymath")` ä¼šè‡ªåŠ¨åŠ è½½ `init.lua`ã€‚

!! ğŸ“„ 1. `mymath/add.lua`

```lua
local M = {}

function M.add(a, b)
    return a + b
end

return M
```

!! ğŸ“„ 2. `mymath/mul.lua`

```lua
local M = {}

function M.mul(a, b)
    return a * b
end

return M
```

!! ğŸ“„ 3. `mymath/init.lua`

è¿™æ˜¯â€œä¸»å…¥å£â€æ¨¡å—ï¼ŒæŠŠå…¶å®ƒå­æ¨¡å—ç»„åˆæˆä¸€ä¸ªâ€œåŒ…â€å¯¹å¤–æä¾›ï¼š

```lua
-- åŠ è½½å­æ¨¡å—
local add = require("mymath.add")
local mul = require("mymath.mul")

-- åˆ›å»ºä¸€ä¸ªtableæš´éœ²API
local M = {}

-- æŠŠæ‰€æœ‰å‡½æ•°æ•´åˆ
M.add = add.add
M.mul = mul.mul

return M
```

!! ğŸ“„ 4. `main.lua`

ä¸»ç¨‹åºè°ƒç”¨ï¼š

```lua
-- è°ƒæ•´ package.path å¦‚æœéœ€è¦
package.path = "./?.lua;./?/init.lua;" .. package.path

-- åŠ è½½æ•´ä¸ªåŒ…
local mymath = require("mymath")

print(mymath.add(10, 20))  -- è¾“å‡º: 30
print(mymath.mul(5, 6))    -- è¾“å‡º: 30
```

!! ğŸ æç¤ºï¼šrequireæœç´¢

ä¸Šé¢ç¤ºä¾‹ä¸­ï¼š

* `require("mymath")`ï¼šä¼šæŸ¥æ‰¾`mymath/init.lua`ã€‚
* `require("mymath.add")`ï¼šä¼šæŸ¥æ‰¾`mymath/add.lua`ã€‚

!! ğŸ¯ è¿›é˜¶ï¼šå­æ¨¡å—ç§æœ‰

å¦‚æœä½ æƒ³åªè®©`init.lua`æš´éœ²APIï¼Œè€Œä¸è®©å¤–éƒ¨ç›´æ¥`require("mymath.add")`ï¼Œå¯ä»¥ä¸æŠŠ`mymath`ç›®å½•åŠ åˆ°`package.path`ï¼Œåªä¿ç•™`mymath/init.lua`è·¯å¾„ã€‚

!! ğŸ¯ è¿›é˜¶ï¼šè‡ªåŠ¨åˆå¹¶æ‰€æœ‰å­æ¨¡å—

å¦‚æœæ¨¡å—è¾ƒå¤šï¼Œä¹Ÿå¯ä»¥åœ¨`init.lua`é‡Œç”¨å¾ªç¯åŠ¨æ€åŠ è½½ï¼š

```lua
local M = {}

-- å®šä¹‰è¦åŠ è½½çš„å­æ¨¡å—
local submodules = {"add", "mul"}

for _, name in ipairs(submodules) do
    local mod = require("mymath." .. name)
    for k, v in pairs(mod) do
        M[k] = v
    end
end

return M
```

è¿™æ ·ä»¥åä½ åªéœ€è¦æŠŠæ–°æ¨¡å—æ”¾åˆ°`submodules`åˆ—è¡¨ï¼Œå°±èƒ½è‡ªåŠ¨åˆå¹¶ã€‚

!! æ€»ç»“

è¿™ä¸ªä¾‹å­å±•ç¤ºäº†''å¤šæ–‡ä»¶æ¨¡å—ç»„ç»‡''ï¼š

* âœ… æ¯ä¸ªåŠŸèƒ½æ‹†åˆ†åˆ°ç‹¬ç«‹æ–‡ä»¶
* âœ… ç”¨`init.lua`ç»Ÿä¸€å‡ºå£
* âœ… éµå¾ªæ¸…æ™°çš„ç›®å½•ç»“æ„
* âœ… å¯¹å¤–æš´éœ²ä¸€ä¸ªæ•´åˆå¥½çš„API

å¦‚æœä½ æƒ³ï¼Œæˆ‘å¯ä»¥å†æ¼”ç¤º''å¸¦å­ç›®å½•''ã€''LuaRocksåŒ…''æˆ–''Cæ‰©å±•''çš„é«˜çº§ç¤ºä¾‹ã€‚éšæ—¶å‘Šè¯‰æˆ‘ï¼