created: 20250629042521420
description: Lua table åŸºç¡€
modified: 20250629101459729
modifier: uzvg
progress: Completed
rating: Plain
source: LuaçŸ¥è¯†ç‚¹å¤§çº²
tags: PermanentNotes Lua
title: Lua tableåŸºç¡€
type: text/vnd.tiddlywiki
visibility: Public

!! å‰è¨€ï¼š

Luaä¸­tableçš„åŸºç¡€çŸ¥è¯†ï¼Œä¸»è¦åŒ…æ‹¬äº†ä»¥ä¸‹å†…å®¹ï¼š

# ''è¡¨çš„åˆ›å»º''
# ''è¡¨çš„è®¿é—®''
# ''è¡¨çš„ä¿®æ”¹''
# ''è¡¨çš„åˆ é™¤''
# ''è¡¨çš„éå†''
# ''è¡¨çš„é•¿åº¦''
# ''è¡¨çš„å…ƒè¡¨ï¼ˆmetatableï¼‰ä¸å…ƒæ–¹æ³•''
# ''å¸¸ç”¨çš„è¡¨æ“ä½œå‡½æ•°ï¼ˆ`table`åº“ï¼‰''
# ''è¡¨ä¸å¼•ç”¨''

!! 1ï¸âƒ£ è¡¨çš„åˆ›å»º

!!! ğŸ“˜ åŸºæœ¬åˆ›å»º

```lua
-- åˆ›å»ºä¸€ä¸ªç©ºè¡¨
local t = {}
```

```lua
-- åˆ›å»ºä¸€ä¸ªåˆå§‹åŒ–çš„è¡¨
local person = {name = "Alice", age = 30}
```

> ''æ³¨æ„ï¼š''

* Luaè¡¨æ—¢å¯ä»¥çœ‹ä½œæ•°ç»„ï¼Œä¹Ÿå¯ä»¥çœ‹ä½œå­—å…¸ï¼ŒäºŒè€…æ²¡æœ‰æœ¬è´¨åŒºåˆ«ã€‚

!! 2ï¸âƒ£ è¡¨çš„è®¿é—®

!!! ğŸ“˜ ä½¿ç”¨ç‚¹è¯­æ³•ï¼ˆå­—æ®µåæ˜¯åˆæ³•æ ‡è¯†ç¬¦ï¼‰

```lua
print(person.name)  --> Alice
```

!!! ğŸ“˜ ä½¿ç”¨æ–¹æ‹¬å·ï¼ˆä»»ä½•ç±»å‹çš„keyï¼‰

```lua
print(person["name"])  --> Alice
```

```lua
local t = {}
t[10] = "Ten"
print(t[10])  --> Ten
```

> ''æ³¨æ„ï¼š''

* ç‚¹è¯­æ³•åªèƒ½ç”¨äºå­—ç¬¦ä¸²keyä¸”keyæ˜¯åˆæ³•æ ‡è¯†ç¬¦ï¼ˆä¸èƒ½åŒ…å«ç©ºæ ¼æˆ–ç‰¹æ®Šå­—ç¬¦ï¼‰ã€‚
* æ–¹æ‹¬å·å¯ä»¥ç”¨äº''ä»»ä½•keyç±»å‹''ã€‚

!! 3ï¸âƒ£ è¡¨çš„ä¿®æ”¹

!!! ğŸ“˜ æ·»åŠ æˆ–æ›´æ–°é”®å€¼

```lua
person.age = 31      -- æ›´æ–°
person.gender = "F"  -- æ–°å¢
```

```lua
t[20] = "Twenty"
```

> ''æ³¨æ„ï¼š''

* è¡¨ä¸­ä¸å­˜åœ¨çš„keyèµ‹å€¼ï¼Œç›¸å½“äºæ–°å¢ã€‚

!! 4ï¸âƒ£ è¡¨çš„åˆ é™¤

!!! ğŸ“˜ åˆ é™¤å…ƒç´ ï¼ˆè®¾ç½®ä¸ºnilï¼‰

```lua
person.age = nil
```

> ''æ³¨æ„ï¼š''

* Luaæ²¡æœ‰çœŸæ­£çš„â€œåˆ é™¤å‡½æ•°â€ï¼Œè®¾ç½®ä¸º`nil`å³è¡¨ç¤ºåˆ é™¤ã€‚
* å¦‚æœæ˜¯æ•°ç»„éƒ¨åˆ†ï¼Œåˆ é™¤ä¼šå½±å“`#`è¿ç®—ç¬¦çš„é•¿åº¦ã€‚

!! 5ï¸âƒ£ è¡¨çš„éå†

!!! ğŸ“˜ `pairs()` éå†æ‰€æœ‰é”®å€¼

```lua
local t = {a=1, b=2, c=3}
for k, v in pairs(t) do
    print(k, v)
end
```

è¾“å‡ºï¼š

```
a   1
b   2
c   3
```

> ''æ³¨æ„ï¼š''

* `pairs()`å¯ä»¥éå†æ‰€æœ‰keyï¼ˆåŒ…æ‹¬éæ•´æ•°keyï¼‰ã€‚

!!! ğŸ“˜ `ipairs()` é¡ºåºéå†æ•°ç»„éƒ¨åˆ†ï¼ˆä»1å¼€å§‹åˆ°ç¬¬ä¸€ä¸ª`nil`ï¼‰

```lua
local arr = {"one", "two", "three"}
for i, v in ipairs(arr) do
    print(i, v)
end
```

è¾“å‡ºï¼š

```
1   one
2   two
3   three
```

> ''æ³¨æ„ï¼š''

* å½“é‡åˆ°ç¬¬ä¸€ä¸ª`nil`å³åœæ­¢ã€‚
* ä¸é€‚ç”¨äºç¨€ç–æ•°ç»„ï¼ˆä¸­é—´æœ‰nilï¼‰ã€‚

!! 6ï¸âƒ£ è¡¨çš„é•¿åº¦

!!! ğŸ“˜ `#` è¿ç®—ç¬¦

```lua
local arr = {"a", "b", "c"}
print(#arr)  --> 3
```

> ''æ³¨æ„ï¼š''

* `#`åªç»Ÿè®¡''ä»ç´¢å¼•1å¼€å§‹è¿ç»­énilå…ƒç´ ''ã€‚
* å¦‚æœä¸­é—´æœ‰nilï¼Œç»“æœä¸å¯é¢„æµ‹ã€‚

ç¤ºä¾‹ï¼š

```lua
local arr = {"a", nil, "c"}
print(#arr)  --> 1 æˆ– 3 (å®ç°ç›¸å…³)
```

!! 7ï¸âƒ£ è¡¨çš„å…ƒè¡¨ä¸å…ƒæ–¹æ³•

è¡¨å¯ä»¥''é€šè¿‡å…ƒè¡¨å®ç°è¿ç®—ç¬¦é‡è½½''ç­‰é«˜çº§åŠŸèƒ½ã€‚

```lua
local t = {}
local mt = {
    __add = function(a,b)
        return a.value + b.value
    end
}
setmetatable(t, mt)

local a = {value=10}
setmetatable(a, mt)
local b = {value=20}
setmetatable(b, mt)

print(a+b)  --> 30
```

> ''æ³¨æ„ï¼š''

* å…ƒè¡¨é«˜çº§ç”¨æ³•è¾ƒå¤šï¼Œè‹¥è¦æ·±å…¥ï¼Œå¯ä»¥å†è¯¦ç»†è®²è§£ã€‚

!! 8ï¸âƒ£ å¸¸ç”¨çš„è¡¨æ“ä½œå‡½æ•° (`table`åº“)

Luaè‡ªå¸¦`table`åº“ï¼Œæä¾›ä¸°å¯Œæ“ä½œï¼š

!!! ğŸ“˜ `table.insert(t, [pos], value)`

åœ¨è¡¨ä¸­æ’å…¥å…ƒç´ ã€‚

```lua
local t = {"a", "b"}
table.insert(t, "c")  -- åœ¨æœ«å°¾æ’å…¥
table.insert(t, 2, "x") -- åœ¨ä½ç½®2æ’å…¥

-- t = {"a", "x", "b", "c"}
```

!!! ğŸ“˜ `table.remove(t, [pos])`

ç§»é™¤å¹¶è¿”å›æŒ‡å®šä½ç½®å…ƒç´ ã€‚

```lua
local t = {"a", "b", "c"}
local v = table.remove(t, 2)  -- ç§»é™¤ "b"
print(v)  --> b
-- t = {"a", "c"}
```

!!! ğŸ“˜ `table.concat(t, sep, i, j)`

æ‹¼æ¥æ•°ç»„éƒ¨åˆ†çš„å­—ç¬¦ä¸²ã€‚

```lua
local t = {"one", "two", "three"}
print(table.concat(t, ", "))  --> one, two, three
```

!!! ğŸ“˜ `table.sort(t, comp)`

å¯¹æ•°ç»„éƒ¨åˆ†æ’åºã€‚

```lua
local t = {5, 2, 9, 1}
table.sort(t)
-- t = {1,2,5,9}
```

è‡ªå®šä¹‰æ’åºï¼š

```lua
table.sort(t, function(a,b)
    return a > b
end)
-- t = {9,5,2,1}
```

!! 9ï¸âƒ£ è¡¨ä¸å¼•ç”¨

!!! ğŸ“˜ è¡¨æ˜¯å¼•ç”¨ç±»å‹

```lua
local t1 = {x=1}
local t2 = t1
t2.x = 100
print(t1.x)  --> 100
```

> ''æ³¨æ„ï¼š''

* ä¸¤ä¸ªå˜é‡æŒ‡å‘''åŒä¸€å—è¡¨''ã€‚
* è‹¥éœ€å…‹éš†è¡¨ï¼Œè¯·è‡ªå·±å†™æ·±æ‹·è´å‡½æ•°ã€‚

# ğŸ é™„åŠ ï¼šç¤ºä¾‹ç»¼åˆ

```lua
-- åˆ›å»ºè¡¨
local t = {name="Tom", scores={90,80,70}}

-- æ·»åŠ 
t.age = 20

-- ä¿®æ”¹
t.name = "Jerry"

-- è®¿é—®
print(t.scores[1])  --> 90

-- åˆ é™¤
t.age = nil

-- éå†
for k,v in pairs(t) do
    print(k,v)
end

-- æ’å…¥æ’åº
local nums = {3,1,4}
table.insert(nums,2)
table.sort(nums)

-- è¾“å‡ºæ’åºå
for i,v in ipairs(nums) do
    print(i,v)
end
```

å¦‚æœéœ€è¦ï¼Œæˆ‘å¯ä»¥è¿›ä¸€æ­¥ï¼š
âœ… æ·±å…¥è®²è§£å…ƒè¡¨
âœ… æ¼”ç¤ºæ·±æ‹·è´è¡¨
âœ… ä¸¾æ›´å¤šå®ç”¨ä¾‹å­

åªéœ€å‘Šè¯‰æˆ‘ï¼
