code-body: yes
created: 20250626084418102
modified: 20260106042831575
tags: 
title: $:/uzvg/ViewTemplates/WeekReport
type: text/vnd.tiddlywiki

\function get-new-line() [charcode[13],[10]]
\procedure journal-template()

============= æ—¥è®° =============
ğŸ“… æ—¥æœŸï¼š${ [<currentTiddler>get[created]format:date[DDth MMM YYYY]] }$
ğŸ““ å†…å®¹ï¼š

${ [<currentTiddler>get[text]] }$
\end

\function get-current-week() [<storyTiddler>get[title]split[ ]last[]]
\function week-journal-context-filter()
	[!is[draft]tag[Journal]]
	:filter[get[created]format:date[WW]match<get-current-week>]
	+[sort[created]]
\end

\function get-context-body()
	[function[week-journal-context-filter]]
	:map[<journal-template>substitute[]]
	+[join<get-new-line>]
\end

\function get-system-prompt()
	[[ä½ æ˜¯æˆ‘çš„å‘¨æŠ¥åŠ©æ‰‹ï¼Œä½ çš„ä»»åŠ¡æ˜¯å¸®åŠ©æˆ‘å¤ç›˜è¿‡å»ä¸€å‘¨å‘ç”Ÿçš„äº‹æƒ…ï¼Œæ‰¾åˆ°æœ‰å“ªäº›å¥½çš„åšæ³•å€¼å¾—å‘æ‰¬ï¼Œåçš„ä¹ æƒ¯éœ€è¦äºæ›´æ”¹ã€‚]jsonstringify[]]
\end

\function get-user-prompt()
	[[è¿™æ˜¯æˆ‘è¿‡å»å…­å¤©çš„æ—¥å¿—ï¼Œè¯·æ ¹æ®æ—¥å¿—çš„å†…å®¹ï¼Œæ€»ç»“æˆ‘ä¸€å‘¨çš„ä¸»è¦æ´»åŠ¨ï¼Œä¸»è¦è¿›åº¦ï¼Œæœ‰å“ªäº›åœ°æ–¹éœ€è¦è°ƒæ•´ï¼Œæœ‰å“ªäº›åœ°æ–¹å¯ä»¥ç»§ç»­å‘æ‰¬ã€‚]]
	[<get-context-body>]
	+[join<get-new-line>]
	+[jsonstringify[]]
\end

<$list filter="[all[current]!is[draft]!is[system]tag[WeekReport]]">
	<span>
		System prompt:
		<$macrocall $name="copy-to-clipboard"
			src=<<get-system-prompt>>
			style="float:left"/>
	</span>
	<span>
		User prompt:
	<$macrocall $name="copy-to-clipboard"
		src=<<get-user-prompt>>
		style="float:right"/>
	</span>
</$list>