created: 20250607035240509
description: python function decorator
modified: 20260207163006776
modifier: uzvg
progress: Completed
rating: Plain
tags: PermanentNotes Python
title: python function decorator
type: text/vnd.tiddlywiki
visibility: Public

<$twks.details summary="Example Code:" state="$:/state/detail" default="open">

```py
from datetime import time, timedelta, datetime
import time

def timer_dec(base_fn):
    def enhanced_fun(*args, **kwargs):
        start_time = time.time()
        result = base_fn(*args, **kwargs)
        end_time = time.time()
        print(f"Cost time: {end_time - start_time} seconds.")
        return result
    return enhanced_fun

@timer_dec
def drink_tea(tea_type: str, steep_time: int) -> None:
    print("Start drinking tea")
    time.sleep(steep_time)
    print(f"{tea_type.title()} tea is ready.")

@timer_dec
def make_matcha():
    print("Start making matcha")
    time.sleep(0)
    print("Matcha is ready.")
    return f"Drinking matcha by {datetime.now() + timedelta(minutes=20)}"

def line_seperator() -> None:
    print("=" * 35)

line_seperator()
drink_tea("green", 0)
line_seperator()
drink_tea(tea_type="red", steep_time=1)
line_seperator()
print(make_matcha()) # å¦‚æœä¸ç”¨printï¼Œåˆ™ä¸ä¼šæ‰“å°æœ€åçš„è¿”å›å€¼
line_seperator()

"""ğŸ“
decoreatoræ¥å—è·Ÿè¿”å›çš„å‚æ•°ï¼Œåªæœ‰å‡½æ•°åã€‚
ä¸æ¥å—inner function çš„å‚æ•°
è¿”å›çš„ä¸åº”è¯¥æ˜¯enhance functionçš„æ‰§è¡Œç»“æœï¼Œè€Œæ˜¯å…¶æœ¬èº«ã€‚
"""
```

</$twks.details>

* decorator æ¥æ”¶å’Œè¿”å›çš„ï¼Œæ˜¯â€œå¯è°ƒç”¨å¯¹è±¡ï¼ˆcallableï¼‰â€ï¼Œé€šå¸¸æ˜¯å‡½æ•°æœ¬èº«ã€‚
* decorator æœ¬èº«åªå¤„ç†å‡½æ•°å¯¹è±¡ï¼›è¢«è£…é¥°å‡½æ•°çš„å‚æ•°ç”± inner functionï¼ˆwrapperï¼‰æ¥æ”¶ã€‚
* decorator å¿…é¡»è¿”å›å‡½æ•°æœ¬èº«ï¼Œè€Œä¸æ˜¯å‡½æ•°çš„æ‰§è¡Œç»“æœã€‚